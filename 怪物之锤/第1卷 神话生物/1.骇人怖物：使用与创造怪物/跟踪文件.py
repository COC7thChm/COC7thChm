import os

# 存放链接的列表
links = [
    "../2.怪异而不同寻常：神话中的怪物/不可名状誓言的信徒.htm",
    "../../第2卷 神话神祗/2.神话诸神/哈斯塔.htm",
    "../2.怪异而不同寻常：神话中的怪物/拜亚基.htm",
    "../../第2卷 神话神祗/2.神话诸神/哈斯塔.htm",
    "../2.怪异而不同寻常：神话中的怪物/斯芬克斯之子.htm",
    "../../第2卷 神话神祗/2.神话诸神/奈亚拉托提普.htm",
    "../2.怪异而不同寻常：神话中的怪物/不可名状誓言的信徒.htm",
    "../2.怪异而不同寻常：神话中的怪物/拜亚基.htm",
    "../2.怪异而不同寻常：神话中的怪物/斯芬克斯之子.htm",
    "../2.怪异而不同寻常：神话中的怪物/黄衣之王的侍臣.htm",
    "../2.怪异而不同寻常：神话中的怪物/黑山羊幼崽.htm",
    "../2.怪异而不同寻常：神话中的怪物/深潜者.htm",
    "../2.怪异而不同寻常：神话中的怪物/斯洛阿住民.htm",
    "../2.怪异而不同寻常：神话中的怪物/深渊住民.htm",
    "../2.怪异而不同寻常：神话中的怪物/炎之精.htm",
    "../2.怪异而不同寻常：神话中的怪物/星海鱼鹰.htm",
    "../2.怪异而不同寻常：神话中的怪物/无形眷族.htm",
    "../2.怪异而不同寻常：神话中的怪物/诺弗·刻.htm",
    "../2.怪异而不同寻常：神话中的怪物/戈茨伍德地精.htm",
    "../2.怪异而不同寻常：神话中的怪物/戈弗恩·胡帕德戈.htm",
    "../2.怪异而不同寻常：神话中的怪物/惊惧猎手.htm",
    "../2.怪异而不同寻常：神话中的怪物/利克斯星居民.htm",
    "../2.怪异而不同寻常：神话中的怪物/潜伏者.htm",
    "../2.怪异而不同寻常：神话中的怪物/米里·尼格利.htm",
    "../2.怪异而不同寻常：神话中的怪物/纳伽埃.htm",
    "../2.怪异而不同寻常：神话中的怪物/夜魇.htm",
    "../2.怪异而不同寻常：神话中的怪物/尼约斯·科盖.htm",
    "../2.怪异而不同寻常：神话中的怪物/人面鼠.htm",
    "../2.怪异而不同寻常：神话中的怪物/潜沙怪.htm",
    "../2.怪异而不同寻常：神话中的怪物/外神仆役.htm",
    "../2.怪异而不同寻常：神话中的怪物/夏塔克鸟.htm",
    "../2.怪异而不同寻常：神话中的怪物/绿渊眷族.htm",
    "../2.怪异而不同寻常：神话中的怪物/克苏鲁的星之眷族.htm",
    "../2.怪异而不同寻常：神话中的怪物/乔乔人.htm",
    "../2.怪异而不同寻常：神话中的怪物/墓中之兽.htm",
    "../2.怪异而不同寻常：神话中的怪物/风行者.htm",
    "../2.怪异而不同寻常：神话中的怪物/齐克洛尔星怪.htm",
    "../2.怪异而不同寻常：神话中的怪物/夏盖妖虫.htm",
    "../2.怪异而不同寻常：神话中的怪物/齐克洛尔星住民.htm",
    "../2.怪异而不同寻常：神话中的怪物/查寇塔.htm",
    "../2.怪异而不同寻常：神话中的怪物/钻地魔虫.htm",
    "../2.怪异而不同寻常：神话中的怪物/星之彩.htm",
    "../2.怪异而不同寻常：神话中的怪物/黑暗蠕行者.htm",
    "../2.怪异而不同寻常：神话中的怪物/雅迪斯居民.htm",
    "../2.怪异而不同寻常：神话中的怪物/空鱼.htm",
    "../2.怪异而不同寻常：神话中的怪物/巨噬蠕虫.htm",
    "../2.怪异而不同寻常：神话中的怪物/空鬼.htm",
    "../2.怪异而不同寻常：神话中的怪物/古老者.htm",
    "../2.怪异而不同寻常：神话中的怪物/飞水螅.htm",
    "../2.怪异而不同寻常：神话中的怪物/妖鬼.htm",
    "../2.怪异而不同寻常：神话中的怪物/食尸鬼.htm",
    "../2.怪异而不同寻常：神话中的怪物/诺弗·刻.htm",
    "../2.怪异而不同寻常：神话中的怪物/伟大种族伊斯.htm",
    "../2.怪异而不同寻常：神话中的怪物/廷达罗斯猎犬.htm",
    "../2.怪异而不同寻常：神话中的怪物/希帕波利亚人.htm",
    "../2.怪异而不同寻常：神话中的怪物/夏盖妖虫.htm",
    "../../第2卷 神话神祗/2.神话诸神/阿撒托斯.htm",
    "../2.怪异而不同寻常：神话中的怪物/罗伊格尔.htm",
    "../2.怪异而不同寻常：神话中的怪物/廷达罗斯统主.htm",
    "../2.怪异而不同寻常：神话中的怪物/玛尔滕斯一族.htm",
    "../2.怪异而不同寻常：神话中的怪物/米-戈.htm",
    "../2.怪异而不同寻常：神话中的怪物/精神寄生体.htm",
    "../2.怪异而不同寻常：神话中的怪物/尼洪·古力.htm",
    "../2.怪异而不同寻常：神话中的怪物/昆扬之民.htm",
    "../2.怪异而不同寻常：神话中的怪物/蛇人.htm",
    "../../第2卷 神话神祗/2.神话诸神/伊格.htm",
    "../2.怪异而不同寻常：神话中的怪物/修格斯.htm",
    "../2.怪异而不同寻常：神话中的怪物/空间吞噬者.htm",
    "../../第2卷 神话神祗/2.神话诸神/道罗斯.htm",
    "../2.怪异而不同寻常：神话中的怪物/星之精.htm",
    "../2.怪异而不同寻常：神话中的怪物/沃尔人.htm",
    "../../第2卷 神话神祗/2.神话诸神/撒托古亚.htm",
    "../../第2卷 神话神祗/2.神话诸神/阿布霍斯.htm",
    "../../第2卷 神话神祗/2.神话诸神/阿特拉克·纳克亚.htm",
    "../2.怪异而不同寻常：神话中的怪物/地蠕.htm",
    "../2.怪异而不同寻常：神话中的怪物/祖·图米·戈.htm",
    "../2.怪异而不同寻常：神话中的怪物/幽格.htm",
    "../2.怪异而不同寻常：神话中的怪物/化尘者.htm",
    "../2.怪异而不同寻常：神话中的怪物/枯败者.htm",
    "../2.怪异而不同寻常：神话中的怪物/寒冷者.htm",
    "../2.怪异而不同寻常：神话中的怪物/蠕行者.htm",
    "../2.怪异而不同寻常：神话中的怪物/齐克洛尔死亡藤蔓.htm",
    "../2.怪异而不同寻常：神话中的怪物/恶魔攀缘者.htm",
    "../2.怪异而不同寻常：神话中的怪物/古神的寄养儿.htm",
    "../2.怪异而不同寻常：神话中的怪物/冷原食尸猎犬.htm",
    "../2.怪异而不同寻常：神话中的怪物/梦境结晶器守护者.htm",
    "../2.怪异而不同寻常：神话中的怪物/地狱水蛭.htm",
    "../2.怪异而不同寻常：神话中的怪物/佩特苏齐.htm",
    "../2.怪异而不同寻常：神话中的怪物/复生者.htm",
    "../2.怪异而不同寻常：神话中的怪物/灵体猎手.htm",
    "../2.怪异而不同寻常：神话中的怪物/猪人.htm",
    "../2.怪异而不同寻常：神话中的怪物/界外幽鬼.htm",
    "../2.怪异而不同寻常：神话中的怪物/廷达罗斯混种.htm",
    "../2.怪异而不同寻常：神话中的怪物/行走的蠕虫.htm"
]

# 基础路径，例如您指定的文件夹
base_path = r"d:\COC不全书\COC7thChm\怪物之锤"

# 检查链接是否有效，并尝试定位新位置
def find_file（filename, search_paths）:
    for path in search_paths:
        candidate_path = os.path.join（path, filename）
        if os.path.exists（candidate_path）:
            return candidate_path
    return None

def track_link（link）:
    # 清除相对路径并生成完整路径
    full_path = os.path.normpath（os.path.join（base_path, link.strip（）.replace（"../", ""）））
    
    if os.path.exists（full_path）:
        return f"链接有效: {full_path}"
    else:
        # 找到文件名
        filename = os.path.basename（full_path）

        # 尝试在多个目录中查找文件
        search_paths = [
            os.path.dirname（full_path）,  # 当前文件夹
            r"d:\COC不全书\COC7thChm\怪物之锤\第1卷 神话生物\2.怪异而不同寻常：神话中的怪物",
            r"d:\COC不全书\COC7thChm\怪物之锤"  # 基本路径
        ]

        # 查找文件
        new_path = find_file（filename, search_paths）
        if new_path:
            return f"链接失效, 但找到新的位置: {new_path}"
        else:
            return f"链接失效: {full_path}"

# 检查所有链接
for link in links:
    result = track_link（link）
    print（result）